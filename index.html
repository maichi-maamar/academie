<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carte NFC – Académie de Football</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f4f6f8;
    color: #222;
}

.container {
    max-width: 420px;
    margin: auto;
    padding: 15px;
}

.academy-name {
    text-align: center;
    font-size: 26px;
    font-weight: bold;
    margin-bottom: 10px;
}

.player-image {
    height: 226px; /* 60 mm */
    background: #ddd;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.player-image img {
    max-height: 100%;
    max-width: 100%;
    border-radius: 10px;
}

.card {
    background: white;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.card h3 {
    margin-top: 0;
    font-size: 18px;
    margin-bottom: 10px;
}

.btn {
    width: 100%;
    padding: 15px;
    background: #1e88e5;
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    cursor: pointer;
}

.footer {
    text-align: center;
    font-size: 13px;
    color: #777;
    margin-top: 20px;
}
</style>
</head>

<body>
<div class="container">

    <div class="academy-name">Académie Football Excellence</div>

    <div class="player-image">
        <img src="joueur.jpg" alt="Photo du joueur">
    </div>

    <div class="card">
        <h3>Informations du joueur</h3>
        <p><strong>Nom :</strong> BENKACEM</p>
        <p><strong>Prénom :</strong> Ahmed</p>
        <p><strong>Âge :</strong> 13 ans</p>
        <p><strong>Poids :</strong> 45 kg</p>
        <p><strong>Catégorie :</strong> U13</p>
        <p><strong>Année sportive :</strong> 2025 – 2026</p>
    </div>

    <div class="card">
        <h3>Académie</h3>
        <p><strong>Entraîneur :</strong> Coach Mourad</p>
        <p><strong>Téléphone :</strong> <a href="tel:+213555000000">+213 555 00 00 00</a></p>
        <p><strong>Facebook :</strong> <a href="https://facebook.com/academie" target="_blank">Page officielle</a></p>
    </div>


    <div class="footer">Carte NFC officielle – Académie</div>

</div>
 
<form
  action="https://script.google.com/macros/s/AKfycbymUhQSwZYK2bH2-JNVeARB4c9SajdaEYgxal5fCAWdHifWX-_VT-xeG7txxjUcUXMr/exec"
  method="GET"
  target="hiddenFrame"
  onsubmit="return false;">

  <input type="hidden" name="player_id" value="AFEX-U13-0007">
  <input type="hidden" name="nom" value="BENKACEM">
  <input type="hidden" name="prenom" value="Ahmed">
  <input type="hidden" name="categorie" value="U13">
  <input type="hidden" name="saison" value="2025-2026">

  <button class="btn" onclick="envoyerPresence()">
    ✔ Enregistrer ma présence
  </button>
</form>

<iframe name="hiddenFrame" style="display:none;" onload="checkResult()"></iframe>

<script>
let alreadyHandled = false;

function envoyerPresence() {
  alreadyHandled = false;
  document.forms[0].submit();
}

function checkResult() {
  if (alreadyHandled) return;
  alreadyHandled = true;

  try {
    const txt = document
      .querySelector("iframe")
      .contentDocument
      .body
      .innerText;

    if (txt.includes("ALREADY")) {
      alert("⛔ Présence déjà enregistrée aujourd’hui");
    } else if (txt.includes("OK")) {
      alert("✅ Présence enregistrée avec succès");
    } else {
      alert("⚠️ Erreur serveur");
    }
  } catch {
    alert("✅ Présence enregistrée");
  }
}
</script>
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Présence NFC</title>
<style>
body { font-family: Arial; text-align:center; }
#msg { font-size:18px; margin-top:20px; }
.ok { color:green; }
.no { color:red; }
</style>
</head>

<body>
<h2>Badge présence</h2>
<p>Approchez la carte NFC</p>
<div id="msg"></div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzuXpOlnAb-exlwxObd0hJT3V2M2pHTJquHiSuY_8LIVeoa8LNGiAirzFSb7Ls6lhYy/exec";

function getReaderID() {
  let id = localStorage.getItem("READER_ID");
  if (!id) {
    id = "READER-" + Math.random().toString(36).substr(2,8);
    localStorage.setItem("READER_ID", id);
  }
  return id;
}

async function scanNFC() {
  const reader = new NDEFReader();
  await reader.scan();

  reader.onreading = event => {
    const uid = event.serialNumber;
    send(uid);
    navigator.vibrate(200);
  };
}

function send(uid) {
  const reader = getReaderID();
  fetch(`${SCRIPT_URL}?uid=${uid}&reader=${reader}`)
    .then(r => r.json())
    .then(d => {
      if (d.status === "OK") {
        msg(`✔ Présence validée : ${d.name}`, "ok");
      } else {
        msg("✖ Présence refusée", "no");
      }
    });
}

function msg(t, c) {
  const m = document.getElementById("msg");
  m.className = c;
  m.innerText = t;
}

scanNFC();
</script>
</body>
</html>

</body>
</html>
